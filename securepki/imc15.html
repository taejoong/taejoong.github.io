<!DOCTYPE html>
<html> 
  <head>
    <title>SSL Research at Northeastern, University of Maryland, and Stanford</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/custom.css">
  </head>
  <body>

    <div class="container">
    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">SSL Research</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li ><a href="contact.html">Who We Are</a></li>
            <li class="dropdown" id="section-research"> 
		<a class="dropdown-toggle" data-toggle="dropdown" href="#">Research<span class="caret"></span></a>
		    <ul class="dropdown-menu" role="menu">
		      <li><a data-toggle="tab"><a href="imc14.html">SSL/IMC'14</a></li>
		      <li class="active"><a data-toggle="tab"><a href="imc15.html">SSL/IMC'15</a></li>
		      <li><a data-toggle="tab"><a href="imc16-invalid.html">SSL/IMC'16</a></li>
		      <li><a data-toggle="tab"><a href="sec17.html">DNSSEC/SEC'17</a></li>
		      <li><a data-toggle="tab"><a href="imc17.html">DNSSEC/IMC'17</a></li>
		    </ul>
	  </li>
            <li><a href="press.html">Press</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="jumbotron">
      <div class="container">
          <h2 align='right'>An End-to-End Measurement of <br>Certificate Revocation in the Webâ€™s PKI </h2>
        <h3 align='right'>
            <a href="http://www.ccs.neu.edu/home/ybliu">Yabing Liu</a>,
            <a href="">Will Tome</a>,
            <a href="www.ccs.neu.edu/home/liang/">Liang Zhang</a>, 
            <a href="http://david.choffnes.com">David Choffnes</a>,
            <a href="http://www.cs.umd.edu/~dml/">Dave Levin</a>,  <br>
            <a href="http://www.cs.cmu.edu/~bmm/">Bruce Maggs</a>, 
            <a href="http://www.ccs.neu.edu/home/amislove/">Alan Mislove</a>,
            <a href="http://cseweb.ucsd.edu/~schulman/">Aaron Schulman</a>, 
            <a href="https://cbw.sh/">Christo Wilson</a>
        </h3>
      </div>
    </div>

    <div class="container">    
        <div class="row">
            <div class="col-md-12">
                <h1 class="page-header" id="Abstract">Paper Overview</h1>
                <p>
                While the overall SSL ecosystem is well-studied, the frequency with which certificates are revoked and the circumstances under which clients (e.g., browsers) check whether certificates are revoked are still not well-understood.
            </br>
                In our IMC'15 paper, we took a close look at certificate revocations in the Web's PKI. Using 74 full IPv4 HTTPS scans, we found that a surprisingly large fraction (8%) of the certificates served have been revoked, and that obtaining certificate revocation information can often be expensive in terms of latency and bandwidth for clients. We then studied the revocation checking behavior of 30 different combinations of web browsers and operating systems; we found that browsers often do not bother to check whether certificates are revoked (including mobile browsers, which uniformly never check). We also examined the CRLSet infrastructure built into Google Chrome for disseminating revocations; we found that CRLSet only covers 0.35% of all revocations. Overall, our results paint a bleak picture of the ability to effectively revoke certificates today.
                </p>
            </div>
        </div>
    </div>

    <div class="container">    
        <div class="row">
            <div class="col-md-12">
                <h1 class="page-header" id="Abstract">Data Sources</h1>
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">SSL Certificates</h2>
                    <p>Our data is provided by <a href="https://www.rapid7.com">Rapid7</a>, who generously makes (roughly) weekly full IPv4 HTTPS scans.  The data can be downloaded from the <a href="https://scans.io/study/sonar.ssl">University of Michigan Internet Scans Repository</a>.  For this study, we use the scans between October 30, 2013 and March 30, 2015. Overall, we observe 38,514,130 unique SSL certificates.</p>
                </div>

                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Alexa Domains</h2>
                    <p>In section 7.2, we compare the revocation in CRLs from <a href="http://s3.amazonaws.com/alexa-static/top-1m.csv.zip">Alexa Top 1 Million</a> domains with the CRLSets.</p>
                </div>

                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Trusted Root Set</h2>
                    We use the <a href="https://support.apple.com/en-us/HT202858">Root Store in OSX 10.9.2</a> as our set of trusted root.
                </div>
            </div>
        </div>
    </div>

    <div class="container">    
        <div class="row">
            <div class="col-md-12">
                <h1 class="page-header" id="Abstract">Processed Data </h1>

<h5>Intermediate Set</h5>
<p>We verify all observed certificates by first building the set of all intermediates certificates that can be verified relative to the roots. And we discover 1,946 intermediate certificates, which we refer to as the Intermediate Set.</p>

<h5>Leaf Set</h5>
<p>We then verify all leaf certificates using this set of intermediates and root certificates. And we discover a total of 5,067,476 such leaf certificates, which we refer to as the Leaf Set.</p>

<h5>Revocation Status</h5>
<p>To determine the revocation status for all valid certificates from these scans, we check the status for Intermediate Set and Leaf Set every day, starting in October, 2014.</p>

<h5>CRL</h5>
<p>For the certificates that include a CRL distribution point, we use this CRL to obtain revocation information for the certificate. We observe a total of 2,800 unique CRLs, and we configure a crawler to download each of these CRLs once per day between October 2, 2014 and March 31, 2015.</p>

<h5>OCSP</h5>
<p>We observe a total of 499 unique OCSP responders across all certificates. And we only query the OCSP responders for the 642 certificates that only have an OCSP responder provided (i.e., no CRL distribution point). This data was collected on March 31, 2015.</p>

<h5>OSCP Stapling</h5>
<p>To determine what fraction of certificates are hosted on servers that support OCSP Stapling, we use the IPv4 TLS Handshake scans conducted by the University of Michigan, which can be downloaded from <a href="https://scans.io/series/443-https-tls-full_ipv4">this link</a>. We examine the scan of March 28, 2015, and look for servers that were advertising certificates in the Leaf Set.</p>

<h5>CRLSets</h5>
<p>To examine Google's approach <a href="https://www.imperialviolet.org/2012/02/05/crlsets.html">CRLSets</a>, we fetch the files once per day between September 23, 2014 and March 31, 2015, and crawled 110 historical CRLSets originally published between July 18th, 2013 and September 23, 2014; in total our dataset contains <a href="data/crlsets.tar.gz">300 unique CRLSets</a>.</p>

<h5>Certificate Database</h5>
<p>We place all 5,067,476 valid certificates we find into a <a href="http://www.sqlite.org">SQLite</a> database. This database can be downloaded from <a href="data/client.db.gz">this link</a> (in total 2.9GB).  There are a number of tables in this database, which are briefly described below.
<ul>

<li><b><tt>domains</tt></b>: This is a table containing one entry for each domain. Included fields are:
<ul>
<li><tt>domainid</tt> The index of the domain</li>
<li><tt>domain</tt> The name of the domain</li>
<li><tt>alexa</tt> The index of the domain within the Alexa Top 1 Million domains (Empty if not among them)</li>
</ul>
</li>

<li><b><tt>certs</tt></b>: This is a table containing one entry for valid leaf certificate.  Included fields are:
<ul>
<li><tt>certid</tt> The index of this certificate</li>
<li><tt>fingerprint</tt> The "fingerprint" of this certificate</li>
<li><tt>version</tt> The version of this certificate</li>
<li><tt>ca</tt> Whether or not this certificate is a CA certificate</li>
<li><tt>cn</tt> The common name of the certificate</li>
<li><tt>sans</tt> The subject alternative names of this certificate</li>
<li><tt>icn</tt> The common name of the issuer of this certificate</li>
<li><tt>serial</tt> The serial number of this certificate</li>
<li><tt>key</tt> The public key of this certificate</li>
<li><tt>isev</tt> Whether or not this certificate is a EV certificate</li>
<li><tt>start</tt> The beginning date of validity for this certificate</li>
<li><tt>end</tt> The ending date of validity for this certificate</li>
<li><tt>birth</tt> This certificate's date of birth (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
<li><tt>death</tt> This certificate's date of death (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
<li><tt>last</tt> The time when this certificate has been last seen</li>
<li><tt>maxhosts</tt>  The number of hosts who advertised this certificate</li>
<li><tt>revoked</tt> This certificate's date of revocation (Empty if not revoked)</li>
<li><tt>revokedreason</tt> This certificate's Reason Code for revocation (-1 if revoked but no reason provided)</li>
<li><tt>skeyid</tt> The signature public key identifier of this certificate</li>
<li><tt>akeyid</tt> The authority key identifier of this certificate</li>
<li><tt>crlsetparent</tt> This certificate is covered by the crlset</li>
<li><tt>crlsetfirst</tt> The first crlset that we have seen this certificate</li>
<li><tt>crlsetlast</tt> The last crlset that we have seen this certificate</li>
</ul>
</li>

<li><b><tt>oids</tt></b>: This is a table containing one entry for each OID. Included fields are:
<ul>
<li><tt>oidid</tt> The index of this OID</li>
<li><tt>oid</tt> The name of this OID</li>
<li><tt>ev</tt> Whether or not this OID is associated with a EV certificate</li>
</ul>
</li>

<li><b><tt>crlsdetail</tt></b>: This is a table containing one entry for each unique CRL. Included fields are:
<ul>
<li><tt>crl</tt> The name of this CRL</li>
<li><tt>crlhash</tt> The hash of this CRL's URL (for referencing purposes)</li>
<li><tt>certs</tt> The number of certificates in this CRL</li>
<li><tt>size</tt> The size of this CRL</li>
</ul>
</li>

<li><b><tt>crlentries</tt></b>: This is a table containing the entries corresponding to our certificates in the CRLs. Included fields are:
<ul>
<li><tt>crlid</tt> The index of this entry</li>
<li><tt>serial</tt> The serial number of this entry</li>
<li><tt>revokedtime</tt> The time when the entry has been revoked</li>
<li><tt>reason</tt> This certificate's Reason Code for revocation (-1 if revoked but no reason provided)</li>
<li><tt>firstseen</tt> The time when the entry has been first seen in one CRL</li>
<li><tt>lastseen</tt> The time when the entry has been last seen in one CRL</li>
</ul>
</li>

<li><b><tt>crls</tt></b>: This is a table containing one entry for each unique CRL. Included fields are:
<ul>
<li><tt>crlid</tt> The index of this CRL</li>
<li><tt>crl</tt> The name of this CRL</li>
<li><tt>hash</tt> The unique index of this CRL</li>
</ul>
</li>

<li><b><tt>crlsizes</tt></b>: This is a table containing one entry for each unique CRL. Included fields are:
<ul>
<li><tt>size</tt> The size of this CRL</li>
<li><tt>hash</tt> The unique index of this CRL</li>
</ul>
</li>

<li><b><tt>crlnames</tt></b>: This is a table containing one entry for each unique CRL. Included fields are:
<ul>
<li><tt>crl</tt> The name of this CRL</li>
<li><tt>hash</tt> The unique index of this CRL</li>
</ul>
</li>

<li><b><tt>ocsps</tt></b>: This is a table containing one entry for each unique OCSP. Included fields are:
<ul>
<li><tt>ocspid</tt> The index of this entry</li>
<li><tt>ocsp</tt> The name of the OCSP responder</li>
</ul>
</li>

<li><b><tt>ocspstapling</tt></b>: This is a table containing one entry for each unique OCSP Stapling. Included fields are:
<ul>
<li><tt>certhash</tt> The index of this certificate</li>
<li><tt>stapled</tt>  The number of servers that we have seen this certificate with stapled response</li>
<li><tt>notstapled</tt> The number of servers that we have seen this certificate without stapled response</li>
</ul>
</li>

<li><b><tt>certdomains</tt></b>: This is a table containing the mapping between certificates and domains. Included fields are:
<ul>
<li><tt>certid</tt> The index of the certificate</li>
<li><tt>domainid</tt> The index of the domain</li>
</ul>
</li>

<li><b><tt>certcrls</tt></b>: This is a table containing the mapping between certificates and CRLs. Included fields are:
<ul>
<li><tt>certid</tt> The index of the certificate</li>
<li><tt>crlid</tt> The index of the CRL</li>
</ul>
</li>

<li><b><tt>certocsps</tt></b>: This is a table containing the mapping between certificates and OCSP. Included fields are:
<ul>
<li><tt>certid</tt> The index of the certificate</li>
<li><tt>ocspid</tt> The index of the OCSP</li>
</ul>
</li>

<li><b><tt>certoids</tt></b>: This is a table containing the mapping between certificates and OIDs. Included fields are:
<ul>
<li><tt>certid</tt> The index of the certificate</li>
<li><tt>oidid</tt> The index of the OID</li>
</ul>
</li>

<li><b><tt>crlsetcrls</tt></b>: This is a table containing the mapping between CRLSets and CRLs. Included fields are:
<ul>
<li><tt>parent</tt> The hash of the public key of the CA that cover the CRL</li>
<li><tt>crlid</tt> The unique index of the CRL</li>
</ul>
</li>

<li><b><tt>crlsetentries</tt></b>: This is a table containing one entry for each unique CRLSet. Included fields are:
<ul>
<li><tt>parent</tt> The hash of the public key of the CA that signed this entry</li>
<li><tt>serial</tt> The serial number of this entry</li>
<li><tt>firstseen</tt> The time when the entry has been first seen in one CRLSet</li>
<li><tt>lastseen</tt> The time when the entry has been last seen in one CRLSet</li>
</ul>
</li>

<li><b><tt>months</tt></b>:  This is a table containing one entry for each month. Included fields are:
<ul>
<li><tt>month</tt> The month information, between 2013/10 ~ 2015/03.</li>
</ul>
</li>

</ul>
</p>
            </div> 
        </div>
    </div>

    <div class ="container">
        <div class="row">
            <div class="col-md-12">
                <h1 class="page-header" id="NXDomain">Test Suite</h1>
Our test suite is currently offline. However, below are some test examples.<p></p>

Examples to test how browsers deal with the revocations when both CRL distribution point and OCSP responder are available:
<ul>
<li>EV certificate, 0 intermediates, leaf revoked (test308) -- This is EV certificate with 0 intermediates, and leaf revoked.</li>
<li>EV certificate, 0 intermediates, leaf revoked, No response CRL failure (test309) -- This is EV certificate with 0 intermediates, and leaf revoked. And the CRL server does not respond.</li>
<li>EV certificate, 0 intermediates, leaf revoked, No response OCSP failure (test310) -- This is EV certificate with 0 intermediates, and leaf revoked. And the OCSP server does not respond.</li>
</ul>

Examples to test how browsers deal with the CRL revocations:
<ul>
<li>EV certificate, 0 intermediates, leaf revoked (test145) -- This is EV certificate with 0 intermediates, and leaf revoked.</li>
<li>EV certificate, 0 intermediates, leaf revoked, 404 failure (test146) -- This is EV certificate with 0 intermediates, and leaf revoked. And the revocation server returns a HTTP 404 error code.</li>
<li>EV certificate, 0 intermediates, leaf revoked, NXDOMAIN failure (test148) -- This is EV certificate with 0 intermediates, and leaf revoked. And the domain name of the revocation server does not exist.</li>
<li>EV certificate, 0 intermediates, leaf revoked, No response failure (test147) -- This is EV certificate with 0 intermediates, and leaf revoked. And the CRL revocation server does not respond.</li>
<li>EV certificate, 0 intermediates, none revoked (test144) -- This is EV certificate with 0 intermediates, and not revoked.</li>
<li>EV certificate, 2 intermediates, intermediate 1/2 revoked (test159) -- This is EV certificate with 2 intermediates, and the 1st intermediate revoked.</li>
<li>EV certificate, 2 intermediates, intermediate 2/2 revoked (test160) -- This is EV certificate with 2 intermediates, and the 2nd intermediate revoked.</li>
</ul>

Examples to test how browsers deal with the OCSP revocations:
<ul>
<li>Non-EV certificate, 1 intermediate, intermediate 1/1 revoked (test195) -- This is Non-EV certificate with 1 revoked intermediate.</li>
<li>Non-EV certificate, 1 intermediate, intermediate 1/1 revoked, 404 failure (test197) -- This is Non-EV certificate with 1 revoked intermediate. And the revocation server returns a HTTP 404 error code.</li>
<li>Non-EV certificate, 1 intermediate, intermediate 1/1 revoked, NXDOMAIN failure (test201) -- This is Non-EV certificate with 1 revoked intermediate. And the domain name of the revocation server does not exist.</li>
<li>Non-EV certificate, 1 intermediate, intermediate 1/1 revoked, No response failure (test199) -- This is Non-EV certificate with 1 revoked intermediate. And the revocation server does not respond.</li>
<li>Non-EV certificate, 1 intermediate, intermediate 1/1 revoked, Unknown response failure (test203) -- This is Non-EV certificate with 1 revoked intermediate. And the OCSP responder generates a response with status unknown.</li>
</ul>

Examples to test how browsers deal with the OCSP Stapling revocations:
<ul>
<li>Non-EV certificate, 3 intermediates, leaf revoked (test330) -- This is Non-EV certificate with 3 intermediates, and leaf revoked.</li>
<li>Non-EV certificate, 3 intermediates, leaf revoked, Unknown response failure (test331) -- This is Non-EV certificate with 3 intermediates, and leaf revoked. And the OCSP Stapling responder generates a response with status unknown.</li>
<li>Non-EV certificate, 3 intermediates, none revoked (test329) -- This is Non-EV certificate with 3 intermediates, and not revoked.</li>
</ul>
<p></p>

</div>
</div>
</div>

  </body>
</html>
