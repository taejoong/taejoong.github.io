<!DOCTYPE html>
<html> 
  <head>
    <title>SSL Research at Northeastern, University of Maryland, and Stanford</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="/css/custom.css">
  </head>
  <body>

    <div class="container">
    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">SSL Research</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Home</a></li>
            <li ><a href="contact.html">Who We Are</a></li>
            <li class="dropdown" id="section-research"> 
		<a class="dropdown-toggle" data-toggle="dropdown" href="#">Research<span class="caret"></span></a>
		    <ul class="dropdown-menu" role="menu">
		      <li class="active"><a data-toggle="tab"><a href="imc14.html">SSL/IMC'14</a></li>
		      <li><a data-toggle="tab"><a href="imc15.html">SSL/IMC'15</a></li>
		      <li><a data-toggle="tab"><a href="imc16-invalid.html">SSL/IMC'16</a></li>
		      <li><a data-toggle="tab"><a href="sec17.html">DNSSEC/SEC'17</a></li>
		      <li><a data-toggle="tab"><a href="imc17.html">DNSSEC/IMC'17</a></li>
		    </ul>
	  </li>
            <li><a href="press.html">Press</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="jumbotron">
      <div class="container">
        <h2 align='right'>Analysis of SSL Certificate Reissues and Revocations<br> in the Wake of Heartbleed</h2>
        <h3 align='right'>
            <a href="www.ccs.neu.edu/home/liang/">Liang Zhang</a>, 
            <a href="http://david.choffnes.com">David Choffnes</a>,
            <a href="http://www.cs.umd.edu/~dml/">Dave Levin</a>,  <br>
            <a href="www.umiacs.umd.edu/~tdumitra/">Tudor Dumitras</a>, 
            <a href="http://www.ccs.neu.edu/home/amislove/">Alan Mislove</a>,
            <a href="http://cseweb.ucsd.edu/~schulman/">Aaron Schulman</a>, 
            <a href="https://cbw.sh/">Christo Wilson</a>
        </h3>
      </div>
    </div>

  <div class="container">
      <div class="row">
          <div class="col-md-12">
                <h1 class="page-header" id="Abstract">Paper Overview</h1>
In April, 2014, we conducted a study to tell how SSL certificates are reissued and revoked in response to a widespread vulnerability, Heartbleed, that enabled undetectable key compromise. We conducted large-scale measurements and developed new methodologies and heuristics to determine how the most popular 1 million web sites reacted to this vulnerability in terms of certificate management, and how this impacts security for clients that use them.</p>
					
<p>We found that the vast majority of vulnerable certificates have not been reissued; further, of those domains that reissued certificates in response to Heartbleed, 60% do not revoke their vulnerable certificates.  If they do not eventually become revoked, 20% of those certificates will remain valid (not expire) for two or more years. The ramifications of this findings are alarming: modern Web browsers will remain potentially vulnerable to malicious third parties using stolen keys to masquerade as a compromised site for a long time to come. We analyzed these trends with vulnerable Extended Validation (EV) certificates, as well, and have found that, while they exhibit better security practices, they still remain largely not reissued (67%) and not revoked (88%) even weeks after the vulnerability was made public. </p>
<h4 align='center'> This paper was published at IMC'2014 (Internet Measurement Conference) and you can download our paper <a href="paper/imc14.pdf">here</a></h4>
            </div>
        </div>
  </div>

  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <h1 class="page-header" id="data"> Data Sources </h1>
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">SSL Certificates </h2>
                    <p>Our data is provided by <a href="https://www.rapid7.com">Rapid7</a>, who generously makes (roughly) weekly full IPv4 HTTPS scans.  The data can be downloaded from the <a href="https://scans.io">University of Michigan Internet Scans Repository</a>.  For this study, we use the scans between October 30, 2013 and April 28, 2014.</p>
                </div>
      
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Alexa Domains</h2>
                    <p>We filter the SSL certificates to only consider those that advertise a Common Name in the <a href="http://s3.amazonaws.com/alexa-static/top-1m.csv.zip">Alexa Top 1 Million</a> domains.</p>
                </div>
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Vulnerability Scan</h2>
      <p>To determine if a host is running a version of OpenSSL that was likely vulnerable in the past, we conduct our own scan.  Please use the <a href="#contact">Contact Us</a> link if you need access to this data set.</p>
                </div>
          </div>
      </div>
  </div>
        
  <div class="container">
      <div class="row">
          <div class="col-md-12">
              <h1 class="page-header" id="data"> Processed Data </h1>
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Verification of Certificate Chais</h2>
                    <p>For each Alexa-domain-advertising certificate we encounter, we validate the certificate's chain using <a href="https://www.openssl.org/docs/apps/verify.html"><tt>openssl verify</tt></a>.  For certificate chains that were advertised in the past, we use the <a href="http://www.code-wizards.com/projects/libfaketime/">Faketime</a> library in combination with OpenSSL.
                </div>
                
                <div class="col-lg-10">
                    <h2 class="page-header" id="Data">Certificate Database</h2> 
                    <p>We place all 628,692 valid, Alexa-domain-advertising certificates we find into a <a href="http://www.sqlite.org">SQLite</a> database.  This database can be downloaded from <a href="data/heartbleed.db.gz">this link</a> (552 MB).  There are a number of tables in this database, which are briefly described below.

              <ul>
              <li><b><tt>scans</tt></b>:  This is a table containing one entry for each of Rapid7's scans.  Included fields are:
                <ul>
                <li><tt>scandate</tt> The date of the scan</li>
                <li><tt>scannextscandays</tt> The number days until the next scan</li>
                <li><tt>scanprevscandays</tt> The number of days since the previous scan</li>
                </ul>
              </li>
              <li><b><tt>domains</tt></b>: This is a table containing one entry for each Alexa Top 1 Million domain.  Included fields are:
                <ul>
                <li><tt>domainid</tt> The index of the domain</li>
                <li><tt>domainname</tt> The name of the domain</li>
                </ul>
              </li>
              <li><b><tt>certs</tt></b>: This is a table containing one entry for valid leaf certificate.  Included fields are:
                <ul>
                <li><tt>certid</tt> The unique index of the certificate</li>
                <li><tt>domainid</tt> The domain to which this certificate belongs</li>
                <li><tt>certhash</tt> The "fingerprint" of this certificate</li>
                <li><tt>certseq</tt> The sequence number of this certificate, as assigned by the issuing CA</li>
                <li><tt>certvalidstart</tt> The beginning date of validity for this certificate</li>
                <li><tt>certvalidstart</tt> The ending date of validity for this certificate</li>
                <li><tt>certissuername</tt> The Authority Name of this certificate</li>
                <li><tt>certname</tt> The Common Name of this certificate</li>
                <li><tt>certca</tt> Whether or not this certificate is a CA certificate</li>
                <li><tt>certbirth</tt> This certificate's date of birth (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
                <li><tt>certreissue</tt> This certificate's date of reissue (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
                <li><tt>certhbreissue</tt> This certificate's date of Heartbleed-induced reissue (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
                <li><tt>certdeath</tt> This certificate's date of death (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
                <li><tt>certrevoked</tt> This certificate's date of revocation</li>
                <li><tt>certrevokedreason</tt> This certificate's Reason Code for revocation (-1 if revoked but no reason provided)</li>
                <li><tt>certnumprehbreissues</tt> The number of times a certificate with this Common Name was reissued before April 7, 2014</li>
                <li><tt>certnumscanhosts</tt> The number of hosts who advertised this certificate</li>
                <li><tt>certwasvulnerable</tt> Whether or not this certificate was vulnerable (see the <a href="papers/Heartbleed-IMC.pdf">paper</a> for the definition)</li>
                <li><tt>certisvulnerable</tt> Whether or not this certificate was advertised by a host we observed to be vulnerable </li>
                </ul>
              </li>
              <li><b><tt>crls</tt></b>: This is a table containing one entry for each unique CRL.  Included fields are:
                <ul>
                <li><tt>crlid</tt> The unique index of the CRL</li>
                <li><tt>crlurl</tt> The URL of this CRL</li>
                <li><tt>crlhash</tt> The hash of this CRL's URL (for referencing purposes)</li>
                </ul>
              </li>
              <li><b><tt>certcrls</tt></b>: This is a table containing the mapping between certificates and CRLs.  Included fields are:
                <ul>
                <li><tt>certcrlid</tt> The unique index of this entry</li>
                <li><tt>certhash</tt> The hash of the certificate</li>
                <li><tt>crlhash</tt> The hash of the CRL</li>
                </ul>
              </li>
              <li><b><tt>crlentries</tt></b>: This is a table containing the entries corresponding to our certificates in the CRLs.  Included fields are:
                <ul>
                <li><tt>crlentryid</tt> The unique index of this entry</li>
                <li><tt>certseq</tt> The sequence number of this entry</li>
                <li><tt>certhash</tt> The "fingerprint" of the certificate that this entry corresponds to</li>
                <li><tt>crlhash</tt> The CRL hash that this entry belongs to</li>
                <li><tt>crlentrytime</tt> The time of this revocation entry</li>
                <li><tt>crlentryreason</tt> This certificate's Reason Code for revocation (-1 if no reason provided)</li>
                </ul>
              </li>
              <li><b><tt>hostswitch</tt></b>: This is a table containing the entries for hosts that switch certificates between scans (for the same Common Name).  Included fields are:
                <ul>
                <li><tt>olddate</tt> The previous scan date</li>
                <li><tt>newdate</tt> The next scan date</li>
                <li><tt>oldcerthash</tt> The previous certificate hash</li>
                <li><tt>newcerthash</tt> The new certificate hash</li>
                </ul>
              </li></ul>
            </p>
                </div> 
          </div>
      </div>

      <div class ="container">
          <div class="row">
              <div class="col-md-12">
                  <h1 class="page-header" id="NXDomain">Analysis</h1>
                  Most of the analysis in the paper is expressed as queries against the SQLite database described above.  For example, Figure 5 is generated using the following queries:
      <ul>
      <li><b>Birth:</b> <tt>select certbirth, count(*) cnt from certs where certbirth != "" group by certbirth;</tt></li>
      <li><b>Death:</b> <tt>select certdeath, count(*) cnt from certs where certdeath != "" group by certdeath;</tt></li>
      <li><b>Reissue:</b> <tt>select certreissue, count(*) cnt from certs where certreissue != "" group by certreissue;</tt></li>
      <li><b>Revoke:</b> <tt>select date(certrevoked), count(*) cnt from certs where certrevoked != "" group by date(certrevoked);</tt></li>
      </ul></p>
            </p>
              </div>
          </div>
      </div>
    </div>
  </body>
</html>
